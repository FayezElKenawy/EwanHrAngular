<div class="details cv-modal">
  <div class="modal-dialog modal-lg modalW90">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          {{ "Sales.Fields.LaborData" | translate }}
        </h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!--begin::Form-->
      <div class="modal-body">
        <div class="row tableBody py-2 px-0 mx-0">
          <!-- table  -->
          <div class="col-12 list px-0 mb-3">
            <form
              class="m-form m-form--fit m-form--label-align-right"
              [formGroup]="form"
            >
              <!-- Row 1 -->
              <div class="tableBody row py-2 mx-0 px-0">
                <div class="col-lg-3 col-md-6 col-12">
                  <div class="form-group m-form__group row mx-0 px-0">
                    <div class="col-12 px-0">
                      <label
                        class="form-control-label"
                        for="ExpectedContractDate"
                        >{{
                          "Sales.Fields.ExpectedReplacementDate" | translate
                        }}</label
                      >
                      <span class="required">*</span>
                    </div>
                    <div class="col-12 px-0">
                      <p-calendar
                        placeholder="{{
                          'Sales.Fields.ExpectedReplacementDate' | translate
                        }}"
                        [monthNavigator]="true"
                        [yearNavigator]="true"
                        yearRange="{{ '1900:' + currentYear }}"
                        formControlName="ExpectedContractDate"
                        dateFormat="yy-mm-dd"
                        class="form-control calendar-form-control p-0"
                        [ngClass]="{
                          'is-invalid':
                            submitted && form.get('ExpectedContractDate').errors
                        }"
                      >
                      </p-calendar>
                      <div
                        class="invalid-feedback"
                        *ngIf="
                          form.get('ExpectedContractDate').errors?.required
                        "
                      >
                        {{ "App.Fields.RequiredField" | translate }}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-lg-3 col-md-6 col-12">
                  <div class="form-group m-form__group row mx-0 px-0">
                    <div class="col-12 px-0">
                      <label class="form-control-label">{{'App.Fields.LaborerFileStatusName' | translate}}</label>
                      <span class="required">*</span>
                    </div>
                    <div class="col-12 px-0">
                      <p-autoComplete id="laborerstatus" class="p-0 form-control" field="ArabicName"
                        formControlName="LaborerStatusId" [suggestions]="laborerStatusList" (completeMethod)="
                          getLaborerStatus($event)
                        " (onClear)="onClear('LaborerStatusId')" [forceSelection]="true" [size]="30" [minLength]="1"
                        placeholder="{{'App.Fields.LaborerFileStatusName' | translate}}" [dropdown]="true" [ngClass]="{
                          'is-invalid': submitted && form.get('LaborerStatusId').errors
                        }">
                        <ng-template let-Branch pTemplate="item">
                          <div class="ui-helper-clearfix">
                            <div>
                              {{ Branch.ArabicName }}
                            </div>
                          </div>
                        </ng-template>
                      </p-autoComplete>
                      <div class="invalid-feedback " *ngIf="submitted && form.get('LaborerStatusId').errors?.required">
                        {{'App.Fields.RequiredField' | translate}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- search -->
              <div class="tableBody row py-2 mx-0 px-0">
                <!-- Search -->
                <div class="col-lg-3 col-md-6 col-12">
                  <div class="form-group m-form__group row mx-0 px-0">
                    <div class="col-12 px-0">
                      <input
                        class="form-control"
                        placeholder="{{
                          'Sales.Fields.searchHere' | translate
                        }}"
                        type="text"
                        [(ngModel)]="searchTerm"
                        [ngModelOptions]="{ standalone: true }"
                      />
                    </div>
                  </div>
                </div>

                <div class="col-lg-2 col-md-6 col-12">
                  <div class="form-group m-form__group row mx-0 px-0 mt-2">
                    <div class="col-12 px-0 mt-4">
                      <button
                        class="btn btn-save-cancel btn-brand"
                        type="button"
                        style="margin-top: -31px"
                        (click)="onSearch()"
                      >
                        {{ "App.Buttons.Search" | translate }}
                      </button>
                    </div>
                  </div>
                </div>
              </div>

            </form>
          </div>

          <div class="col-12 list px-0 mb-3 box-shadow">
            <p-table
              #rr
              [columns]="laborerCols"
              [value]="filteredLaborerFileArray"
              [(selection)]="selectedLaborer"
              dataKey="Id"
              [lazy]="true"
              (onLazyLoad)="loadLabores($event)"
              [paginator]="true"
              [rows]="10"
              [totalRecords]="totalRecords"
              [scrollable]="true"
              class="table"
              frozenWidth="6.5%"
            >
              <!-- <ng-template pTemplate="caption">
                <input type="text" pInputText class="w-50 mx-auto form-control"
                  placeholder="{{'App.Fields.Search' |translate}}"
                  (input)="rr.filterGlobal($event.target.value, 'contains')">
              </ng-template> -->

              <ng-template pTemplate="frozenbody" let-dataItems>
                <tr>
                  <td>
                    <span class="d-flex justify-content-center">
                      <span class="d-inline-block">
                        <a
                          data-toggle="modal"
                          data-target="#detailsModal"
                          class="dropdown-item cursor-pointer px-1"
                        >
                        </a>
                      </span>
                    </span>
                  </td>
                </tr>
              </ng-template>

              <ng-template pTemplate="frozenheader">
                <tr class="frozeheader">
                  <th>{{ "App.Fields.Actions" | translate }}</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th style="padding: 0.58em 0.857em; width: 40px"></th>
                  <th
                    *ngFor="let col of columns"
                    [pSortableColumn]="col.field"
                    style="padding: 0.58em 0.857em"
                  >
                    {{ col.header | translate }}
                    <!-- <p-sortIcon [field]="col.field"></p-sortIcon> -->
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr [pSelectableRow]="rowData">
                  <td style="width: 40px">
                    <p-tableRadioButton [value]="rowData"></p-tableRadioButton>
                  </td>
                  <td *ngFor="let col of columns">{{ rowData[col.field] }}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage" let-columns>
                <tr *ngIf="filteredLaborerFileArray?.length === 0">
                  <td [attr.colspan]="columns?.length" class="empty-grid-table">
                    <span class="emp-msg">
                      {{ "App.Fields.NoData" | translate }}
                    </span>
                  </td>
                </tr>
              </ng-template>
            </p-table>
            <div
              class="p-2"
              style="color: #f4516c"
              *ngIf="!selectedLaborer && submitted"
            >
              {{ "Sales.Messages.MustHaveLabourers" | translate }}
            </div>
          </div>

          <div
            class="col-12 m-form__actions m-form__actions ml-lg-auto text-center p-3"
          >
            <button
              class="btn btn-save-cancel btn-brand mb-1"
              type="submit"
              (click)="replaceLaborer()"
            >
              {{ "App.Buttons.Save" | translate }}</button
            >&nbsp;&nbsp;
            <button
              class="btn btn-save-cancel btn-secondary mb-1"
              type="button"
              data-dismiss="modal"
            >
              {{ "App.Buttons.Cancel" | translate }}
            </button>
          </div>
        </div>
      </div>
      <!--
      <div class="modal-footer"></div> -->
      <!--end::Form-->
    </div>
  </div>
</div>
<!-- Progress Spinner -->
<app-shared-progress-spinner
  *ngIf="progressSpinner"
></app-shared-progress-spinner>
